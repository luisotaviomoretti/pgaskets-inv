import{r as m,a as Ee,j as s,I as W,B as E,C as ie,b as le,c as re,S as H,e as Y,f as Q,g as G,h as S,d as ae,M as C,T as Me,i as Ne,k as V,l as I,m as Te,n as N,o as ze}from"./index-CA-mNZEK.js";function P(l,o,e){let t=e.initialDeps??[],n;function i(){var r,a,h,c;let d;e.key&&((r=e.debug)!=null&&r.call(e))&&(d=Date.now());const f=l();if(!(f.length!==t.length||f.some((w,y)=>t[y]!==w)))return n;t=f;let g;if(e.key&&((a=e.debug)!=null&&a.call(e))&&(g=Date.now()),n=o(...f),e.key&&((h=e.debug)!=null&&h.call(e))){const w=Math.round((Date.now()-d)*100)/100,y=Math.round((Date.now()-g)*100)/100,T=y/16,b=(v,_)=>{for(v=String(v);v.length<_;)v=" "+v;return v};console.info(`%c⏱ ${b(y,5)} /${b(w,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*T,120))}deg 100% 31%);`,e?.key)}return(c=e?.onChange)==null||c.call(e,n),n}return i.updateDeps=r=>{t=r},i}function oe(l,o){if(l===void 0)throw new Error("Unexpected undefined");return l}const Oe=(l,o)=>Math.abs(l-o)<1.01,Ie=(l,o,e)=>{let t;return function(...n){l.clearTimeout(t),t=l.setTimeout(()=>o.apply(this,n),e)}},ce=l=>{const{offsetWidth:o,offsetHeight:e}=l;return{width:o,height:e}},ke=l=>l,De=l=>{const o=Math.max(l.startIndex-l.overscan,0),e=Math.min(l.endIndex+l.overscan,l.count-1),t=[];for(let n=o;n<=e;n++)t.push(n);return t},Fe=(l,o)=>{const e=l.scrollElement;if(!e)return;const t=l.targetWindow;if(!t)return;const n=r=>{const{width:a,height:h}=r;o({width:Math.round(a),height:Math.round(h)})};if(n(ce(e)),!t.ResizeObserver)return()=>{};const i=new t.ResizeObserver(r=>{const a=()=>{const h=r[0];if(h?.borderBoxSize){const c=h.borderBoxSize[0];if(c){n({width:c.inlineSize,height:c.blockSize});return}}n(ce(e))};l.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()});return i.observe(e,{box:"border-box"}),()=>{i.unobserve(e)}},de={passive:!0},he=typeof window>"u"?!0:"onscrollend"in window,Re=(l,o)=>{const e=l.scrollElement;if(!e)return;const t=l.targetWindow;if(!t)return;let n=0;const i=l.options.useScrollendEvent&&he?()=>{}:Ie(t,()=>{o(n,!1)},l.options.isScrollingResetDelay),r=d=>()=>{const{horizontal:f,isRtl:j}=l.options;n=f?e.scrollLeft*(j&&-1||1):e.scrollTop,i(),o(n,d)},a=r(!0),h=r(!1);h(),e.addEventListener("scroll",a,de);const c=l.options.useScrollendEvent&&he;return c&&e.addEventListener("scrollend",h,de),()=>{e.removeEventListener("scroll",a),c&&e.removeEventListener("scrollend",h)}},Ae=(l,o,e)=>{if(o?.borderBoxSize){const t=o.borderBoxSize[0];if(t)return Math.round(t[e.options.horizontal?"inlineSize":"blockSize"])}return l[e.options.horizontal?"offsetWidth":"offsetHeight"]},Pe=(l,{adjustments:o=0,behavior:e},t)=>{var n,i;const r=l+o;(i=(n=t.scrollElement)==null?void 0:n.scrollTo)==null||i.call(n,{[t.options.horizontal?"left":"top"]:r,behavior:e})};class _e{constructor(o){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(n=>{n.forEach(i=>{const r=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(r):r()})}));return{disconnect:()=>{var n;(n=t())==null||n.disconnect(),e=null},observe:n=>{var i;return(i=t())==null?void 0:i.observe(n,{box:"border-box"})},unobserve:n=>{var i;return(i=t())==null?void 0:i.unobserve(n)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,n])=>{typeof n>"u"&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:ke,rangeExtractor:De,onChange:()=>{},measureElement:Ae,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var t,n;(n=(t=this.options).onChange)==null||n.call(t,this,e)},this.maybeNotify=P(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t){this.maybeNotify();return}this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this.elementsCache.forEach(n=>{this.observer.observe(n)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(n,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<n?"forward":"backward":null,this.scrollOffset=n,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const n=new Map,i=new Map;for(let r=t-1;r>=0;r--){const a=e[r];if(n.has(a.lane))continue;const h=i.get(a.lane);if(h==null||a.end>h.end?i.set(a.lane,a):a.end<h.end&&n.set(a.lane,!0),n.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((r,a)=>r.end===a.end?r.index-a.index:r.end-a.end)[0]:void 0},this.getMeasurementOptions=P(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,t,n,i,r)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:i,enabled:r}),{key:!1}),this.getMeasurements=P(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:n,getItemKey:i,enabled:r},a)=>{if(!r)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const h=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,h);for(let d=h;d<e;d++){const f=i(d),j=this.options.lanes===1?c[d-1]:this.getFurthestMeasurement(c,d),g=j?j.end+this.options.gap:t+n,w=a.get(f),y=typeof w=="number"?w:this.options.estimateSize(d),T=g+y,b=j?j.lane:d%this.options.lanes;c[d]={index:d,start:g,size:y,end:T,key:f,lane:b}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=P(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,t,n,i)=>this.range=e.length>0&&t>0?Ve({measurements:e,outerSize:t,scrollOffset:n,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=P(()=>{let e=null,t=null;const n=this.calculateRange();return n&&(e=n.startIndex,t=n.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,t]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,t]},(e,t,n,i,r)=>i===null||r===null?[]:e({startIndex:i,endIndex:r,overscan:t,count:n}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const n=this.indexFromElement(e),i=this.measurementsCache[n];if(!i)return;const r=i.key,a=this.elementsCache.get(r);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.elementsCache.set(r,e)),e.isConnected&&this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const n=this.measurementsCache[e];if(!n)return;const i=this.itemSizeCache.get(n.key)??n.size,r=t-i;r!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(n,r,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((t,n)=>{t.isConnected||(this.observer.unobserve(t),this.elementsCache.delete(n))});return}this._measureElement(e,void 0)},this.getVirtualItems=P(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,t)=>{const n=[];for(let i=0,r=e.length;i<r;i++){const a=e[i],h=t[a];n.push(h)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(t.length!==0)return oe(t[fe(0,t.length-1,n=>oe(t[n]).start,e)])},this.getOffsetForAlignment=(e,t,n=0)=>{const i=this.getSize(),r=this.getScrollOffset();t==="auto"&&(t=e>=r+i?"end":"start"),t==="center"?e+=(n-i)/2:t==="end"&&(e-=i);const a=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(a,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=this.measurementsCache[e];if(!n)return;const i=this.getSize(),r=this.getScrollOffset();if(t==="auto")if(n.end>=r+i-this.options.scrollPaddingEnd)t="end";else if(n.start<=r+this.options.scrollPaddingStart)t="start";else return[r,t];const a=t==="end"?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,t,n.size),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),e=Math.max(0,Math.min(e,this.options.count-1));let i=0;const r=10,a=c=>{if(!this.targetWindow)return;const d=this.getOffsetForIndex(e,c);if(!d){console.warn("Failed to get offset for index:",e);return}const[f,j]=d;this._scrollToOffset(f,{adjustments:void 0,behavior:n}),this.targetWindow.requestAnimationFrame(()=>{const g=this.getScrollOffset(),w=this.getOffsetForIndex(e,j);if(!w){console.warn("Failed to get offset for index:",e);return}Oe(w[0],g)||h(j)})},h=c=>{this.targetWindow&&(i++,i<r?this.targetWindow.requestAnimationFrame(()=>a(c)):console.warn(`Failed to scroll to index ${e} after ${r} attempts.`))};a(t)},this.scrollBy=(e,{behavior:t}={})=>{t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;if(t.length===0)n=this.options.paddingStart;else if(this.options.lanes===1)n=((e=t[t.length-1])==null?void 0:e.end)??0;else{const i=Array(this.options.lanes).fill(null);let r=t.length-1;for(;r>=0&&i.some(a=>a===null);){const a=t[r];i[a.lane]===null&&(i[a.lane]=a.end),r--}n=Math.max(...i.filter(a=>a!==null))}return Math.max(n-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(o)}}const fe=(l,o,e,t)=>{for(;l<=o;){const n=(l+o)/2|0,i=e(n);if(i<t)l=n+1;else if(i>t)o=n-1;else return n}return l>0?l-1:0};function Ve({measurements:l,outerSize:o,scrollOffset:e,lanes:t}){const n=l.length-1,i=h=>l[h].start;if(l.length<=t)return{startIndex:0,endIndex:n};let r=fe(0,n,i,e),a=r;if(t===1)for(;a<n&&l[a].end<e+o;)a++;else if(t>1){const h=Array(t).fill(0);for(;a<n&&h.some(d=>d<e+o);){const d=l[a];h[d.lane]=d.end,a++}const c=Array(t).fill(e+o);for(;r>=0&&c.some(d=>d>=e);){const d=l[r];c[d.lane]=d.start,r--}r=Math.max(0,r-r%t),a=Math.min(n,a+(t-1-a%t))}return{startIndex:r,endIndex:a}}const ue=typeof document<"u"?m.useLayoutEffect:m.useEffect;function We(l){const o=m.useReducer(()=>({}),{})[1],e={...l,onChange:(n,i)=>{var r;i?Ee.flushSync(o):o(),(r=l.onChange)==null||r.call(l,n,i)}},[t]=m.useState(()=>new _e(e));return t.setOptions(e),ue(()=>t._didMount(),[]),ue(()=>t._willUpdate()),t}function Le(l){return We({observeElementRect:Fe,observeElementOffset:Re,scrollToFn:Pe,...l})}function Be({open:l,onOpenChange:o,title:e,description:t,tokenLabel:n="Token",token:i="",inputPlaceholder:r="Type the token exactly as shown",confirmLabel:a="Confirm",cancelLabel:h="Cancel",isValid:c,onConfirm:d}){const f=m.useRef(null),j=m.useRef(null),[g,w]=m.useState(""),y=m.useMemo(()=>{const b=v=>(v||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toLowerCase();return v=>b(v)===b(i)},[i]),T=(c??y)(g);return m.useEffect(()=>{if(!l)return;j.current=document.activeElement;const b=f.current?.querySelector("input");w(""),b?.focus();const v=_=>{_.key==="Escape"&&o(!1)};return window.addEventListener("keydown",v),()=>{window.removeEventListener("keydown",v),j.current?.focus?.()}},[l,o]),l?s.jsxs("div",{className:"fixed inset-0 z-50",onClick:()=>o(!1),role:"presentation",children:[s.jsx("div",{className:"absolute inset-0 bg-black/40"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",onClick:b=>b.stopPropagation(),children:s.jsx("div",{ref:f,className:"bg-white rounded-xl shadow-xl w-full max-w-md",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title",children:s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{id:"confirm-dialog-title",className:"text-lg font-medium mb-2",children:e}),t&&s.jsx("div",{className:"text-sm text-slate-600 mb-3",children:t}),(i||n)&&s.jsx("div",{className:"text-sm mb-3",children:s.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border px-2.5 py-1 bg-slate-50",children:[s.jsx("span",{className:"text-xs uppercase text-slate-500",children:n}),s.jsx("span",{className:"font-medium",children:i})]})}),s.jsx(W,{placeholder:r,value:g,onChange:b=>w(b.target.value),className:"h-10"}),s.jsxs("div",{className:"flex gap-2 justify-end mt-4",children:[s.jsx(E,{variant:"outline",onClick:()=>o(!1),children:h}),s.jsx(E,{variant:"destructive",disabled:!T,onClick:()=>{d(),o(!1)},children:a})]})]})})})]}):null}function Ue(l){switch(l){case C.RECEIVE:return"default";case C.PRODUCE:return"default";case C.ISSUE:return"secondary";case C.WASTE:return"secondary";default:return"secondary"}}function qe({className:l}){return s.jsx("svg",{className:l,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}const me=1440*60*1e3;function $e(l,o,e){const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();if(l==="today")return[n,t.getTime()];if(l==="last7")return[t.getTime()-7*me,t.getTime()];if(l==="month")return[new Date(t.getFullYear(),t.getMonth(),1).getTime(),t.getTime()];if(l==="custom"){const r=o?new Date(o+"T00:00:00").getTime():t.getTime()-7*me,a=e?new Date(e+"T23:59:59").getTime():t.getTime();return[Math.min(r,a),Math.max(r,a)]}const i=Math.floor(t.getMonth()/3)*3;return[new Date(t.getFullYear(),i,1).getTime(),t.getTime()]}function Ye({movements:l=[],onDeleteMovement:o,onExportExcel:e}){const[t,n]=m.useState(""),[i,r]=m.useState(""),[a,h]=m.useState(""),[c,d]=m.useState("last7"),[f,j]=m.useState(""),[g,w]=m.useState(""),[y,T]=m.useState(null),[b,v]=m.useState(null),[_,L]=m.useState(!1),[ge,k]=m.useState(1),[B,xe]=m.useState(10),D=m.useDeferredValue(t),F=m.useDeferredValue(i),pe=m.useMemo(()=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",currencyDisplay:"symbol"}),[]),ve=m.useMemo(()=>new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}),[]),J=m.useMemo(()=>["turtle","lion","giraffe","parrot","alligator","jaguar","elephant","wolf","dolphin","eagle"],[]),je=u=>{const p=J[Math.floor(Math.random()*J.length)]||"turtle";v(p),T(u)},ye=u=>l?.find(p=>p.movementId===u),U=m.useMemo(()=>({sku:D,workOrder:F,type:a,period:c,customStart:c==="custom"?f:"",customEnd:c==="custom"?g:""}),[D,F,a,c,f,g]),be=()=>{switch(c){case"today":return"Today";case"last7":return"Last 7 days";case"month":return"Current month";case"quarter":return"Current quarter";case"custom":return f&&g?`${f} to ${g}`:"Custom range (incomplete)";default:return c}},we=()=>{L(!0)},Se=()=>{e&&e(M,U),L(!1)},[X,Z]=m.useMemo(()=>$e(c,f,g),[c,f,g]),M=m.useMemo(()=>{const u=[];return(l||[]).forEach((p,z)=>{if(D&&!p.skuOrName.toLowerCase().includes(D.toLowerCase())||F&&!p.ref.toLowerCase().includes(F.toLowerCase())||a&&p.type!==a)return;const O=p.datetime instanceof Date?p.datetime.getTime():new Date(p.datetime).getTime();O<X||O>Z||u.push([p,z])}),u.sort(([p],[z])=>{const O=p.datetime instanceof Date?p.datetime.getTime():new Date(p.datetime).getTime();return(z.datetime instanceof Date?z.datetime.getTime():new Date(z.datetime).getTime())-O}),u},[l,D,F,a,X,Z]);m.useEffect(()=>{k(1)},[D,F,a,c,f,g]);const q=M.length,R=Math.max(1,Math.ceil(q/B)),A=Math.min(ge,R),$=(A-1)*B,ee=$+B,te=M.slice($,ee),se=m.useRef(null),ne=Le({count:te.length,getScrollElement:()=>se.current,estimateSize:()=>44,overscan:8});return s.jsxs("div",{className:"space-y-4",children:[s.jsxs(ie,{className:"rounded-xl border border-dashed",children:[s.jsx(le,{className:"py-4",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[s.jsx(re,{className:"text-lg",children:"Last Movements"}),s.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-2",children:[s.jsxs(H,{value:c,onValueChange:u=>d(u),children:[s.jsx(Y,{className:"h-8 w-[160px] rounded-xl",children:s.jsx(Q,{placeholder:"Period"})}),s.jsxs(G,{children:[s.jsx(S,{value:"today",children:"Today"}),s.jsx(S,{value:"last7",children:"Last 7 days"}),s.jsx(S,{value:"month",children:"Current month"}),s.jsx(S,{value:"quarter",children:"Current quarter"}),s.jsx(S,{value:"custom",children:"Custom range"})]})]}),c==="custom"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(W,{type:"date",value:f,onChange:u=>j(u.target.value),className:"h-8 rounded-xl w-36"}),s.jsx("span",{className:"text-slate-500",children:"to"}),s.jsx(W,{type:"date",value:g,onChange:u=>w(u.target.value),className:"h-8 rounded-xl w-36"})]})]})]})}),s.jsxs(ae,{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",M.length," of ",l.length," movements"]}),s.jsxs(E,{size:"sm",variant:"outline",onClick:we,disabled:M.length===0,className:"rounded-xl",children:["Export to Excel (",M.length,")"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s.jsx(W,{placeholder:"Filter by SKU or Name",value:t,onChange:u=>n(u.target.value),className:"h-8 rounded-xl"}),s.jsx(W,{placeholder:"Filter by WO",value:i,onChange:u=>r(u.target.value),className:"h-8 rounded-xl"}),s.jsxs(H,{value:a,onValueChange:h,children:[s.jsx(Y,{className:"h-8 w-full rounded-xl",children:s.jsx(Q,{placeholder:"Movement type"})}),s.jsxs(G,{children:[s.jsx(S,{value:"",children:"All types"}),s.jsx(S,{value:C.RECEIVE,children:"RECEIVE"}),s.jsx(S,{value:C.ISSUE,children:"ISSUE"}),s.jsx(S,{value:C.WASTE,children:"WASTE"}),s.jsx(S,{value:C.PRODUCE,children:"PRODUCE"})]})]})]}),s.jsx("div",{ref:se,className:"max-h-96 overflow-auto rounded-md border",children:s.jsxs(Me,{className:"w-full",children:[s.jsx("caption",{className:"sr-only",children:"Last Movements – filtered and paginated list"}),s.jsx(Ne,{children:s.jsxs(V,{children:[s.jsx(I,{scope:"col",children:"Date/Time"}),s.jsx(I,{scope:"col",children:"Type"}),s.jsx(I,{scope:"col",children:"SKU / Output name"}),s.jsx(I,{scope:"col",children:"Qty"}),s.jsx(I,{scope:"col",children:"Value"}),s.jsx(I,{scope:"col",children:"Ref"}),s.jsx(I,{scope:"col",children:"Actions"})]})}),s.jsx(Te,{children:M.length===0?s.jsx(V,{children:s.jsx(N,{colSpan:7,className:"text-sm text-slate-500",children:t||i||a||c!=="last7"||f||g?"No movements match the current filters.":"No movements yet."})}):(()=>{const u=ne.getVirtualItems(),p=u[0]?.start??0,z=u[u.length-1],O=ne.getTotalSize()-(z?.end??0);return s.jsxs(s.Fragment,{children:[p>0&&s.jsx(V,{"aria-hidden":!0,style:{height:p},children:s.jsx(N,{colSpan:7})}),u.map(K=>{const[x,Ke]=te[K.index],Ce=`${x.ref}|${x.datetime}|${x.type}|${x.skuOrName}`;return s.jsxs(V,{"data-index":K.index,children:[s.jsx("th",{scope:"row",className:"px-4 py-2 text-left font-normal",children:ve.format(x.datetime instanceof Date?x.datetime:new Date(x.datetime))}),s.jsx(N,{children:s.jsx(ze,{variant:Ue(x.type),children:x.type})}),s.jsx(N,{children:x.skuOrName}),s.jsx(N,{className:x.qty>0?"text-green-600":"text-red-600",children:x.qty>0?`+${x.qty}`:x.qty}),s.jsx(N,{className:x.value>0?"text-green-600":"text-red-600",children:pe.format(x.value)}),s.jsx(N,{children:x.ref}),s.jsx(N,{children:(x.type===C.PRODUCE||x.type===C.RECEIVE)&&o&&s.jsx(E,{variant:"outline",size:"sm",onClick:()=>je(x.movementId),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50","aria-label":"Delete movement",title:"Delete movement",children:s.jsx(qe,{className:"h-4 w-4"})})})]},Ce)}),O>0&&s.jsx(V,{"aria-hidden":!0,style:{height:O},children:s.jsx(N,{colSpan:7})})]})})()})]})}),s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 pt-2",children:[s.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",q===0?0:$+1,"-",Math.min(ee,q)," of ",q]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(H,{value:String(B),onValueChange:u=>{xe(Number(u)),k(1)},children:[s.jsx(Y,{className:"h-9 w-[110px]",children:s.jsx(Q,{placeholder:"Page size"})}),s.jsxs(G,{children:[s.jsx(S,{value:"10",children:"10 / page"}),s.jsx(S,{value:"25",children:"25 / page"}),s.jsx(S,{value:"50",children:"50 / page"}),s.jsx(S,{value:"100",children:"100 / page"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(E,{variant:"outline",size:"sm",onClick:()=>k(1),disabled:A===1,children:"«"}),s.jsx(E,{variant:"outline",size:"sm",onClick:()=>k(u=>Math.max(1,u-1)),disabled:A===1,children:"Prev"}),s.jsxs("span",{className:"text-sm px-2",children:["Page ",A," / ",R]}),s.jsx(E,{variant:"outline",size:"sm",onClick:()=>k(u=>Math.min(R,u+1)),disabled:A===R,children:"Next"}),s.jsx(E,{variant:"outline",size:"sm",onClick:()=>k(R),disabled:A===R,children:"»"})]})]})]})]})]}),_&&s.jsxs("div",{className:"fixed inset-0 z-50",role:"dialog","aria-modal":"true",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>L(!1)}),s.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[min(100%,500px)]",children:s.jsxs(ie,{className:"rounded-2xl shadow-2xl bg-white",children:[s.jsx(le,{className:"py-4",children:s.jsx(re,{className:"text-lg",children:"Export Movements to Excel"})}),s.jsxs(ae,{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-slate-600",children:["You're about to export ",s.jsxs("strong",{children:[M.length," movement records"]})," to Excel with the following filters applied:"]}),s.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg space-y-2",children:[s.jsx("div",{className:"text-sm font-medium text-slate-700",children:"Active Filters:"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Period:"})," ",be()]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"SKU/Name:"})," ",U.sku||"All"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Work Order:"})," ",U.workOrder||"All"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Movement Type:"})," ",U.type||"All"]})]})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"The exported file will contain: Date, Time, Type, SKU/Product, Quantity, Value, and Reference columns."})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2 p-4 border-t",children:[s.jsx(E,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),s.jsxs(E,{onClick:Se,children:["Export ",M.length," Records"]})]})]})})]}),s.jsx(Be,{open:y!==null,onOpenChange:u=>{u||(T(null),v(null))},title:"Delete Movement",description:s.jsx(s.Fragment,{children:y!==null&&s.jsx("span",{className:"text-sm text-slate-600",children:ye(y)?.type===C.PRODUCE?"This will permanently delete the PRODUCE movement and all related WASTE and ISSUE movements, restoring stock with FIFO integrity.":"This will permanently delete the RECEIVE movement and restore stock with FIFO integrity."})}),tokenLabel:"Animal",token:b||"",inputPlaceholder:"Type the animal exactly as shown",confirmLabel:"Delete",cancelLabel:"Cancel",onConfirm:()=>{y!==null&&o?.(y)}})]})}export{Ye as default};
